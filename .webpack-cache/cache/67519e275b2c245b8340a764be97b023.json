{"remainingRequest":"/wiki/node_modules/babel-loader/lib/index.js??ref--0-1!/wiki/node_modules/vue-loader/lib/index.js??vue-loader-options!/wiki/client/components/editor/editor-modal-media.vue?vue&type=script&lang=js&","dependencies":[{"path":"/wiki/client/components/editor/editor-modal-media.vue","mtime":1716084843882},{"path":"/wiki/.babelrc","mtime":1716084843827},{"path":"/wiki/node_modules/cache-loader/dist/cjs.js","mtime":1716088090639},{"path":"/wiki/node_modules/babel-loader/lib/index.js","mtime":1716088089693},{"path":"/wiki/node_modules/vue-loader/lib/index.js","mtime":1716088146939}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9nZXQgZnJvbSAibG9kYXNoL2dldCI7CmltcG9ydCBfbGFzdCBmcm9tICJsb2Rhc2gvbGFzdCI7CmltcG9ydCBfZGVsYXkgZnJvbSAibG9kYXNoL2RlbGF5IjsKaW1wb3J0IF9maW5kIGZyb20gImxvZGFzaC9maW5kIjsKaW1wb3J0IF9jb21wYWN0IGZyb20gImxvZGFzaC9jb21wYWN0IjsKaW1wb3J0IHsgZ2V0LCBzeW5jIH0gZnJvbSAndnVleC1wYXRoaWZ5JzsKaW1wb3J0IENvb2tpZXMgZnJvbSAnanMtY29va2llJzsKaW1wb3J0IHZ1ZUZpbGVQb25kIGZyb20gJ3Z1ZS1maWxlcG9uZCc7CmltcG9ydCAnZmlsZXBvbmQvZGlzdC9maWxlcG9uZC5taW4uY3NzJzsKaW1wb3J0IGxpc3RBc3NldFF1ZXJ5IGZyb20gJ2dxbC9lZGl0b3IvZWRpdG9yLW1lZGlhLXF1ZXJ5LWxpc3QuZ3FsJzsKaW1wb3J0IGxpc3RGb2xkZXJBc3NldFF1ZXJ5IGZyb20gJ2dxbC9lZGl0b3IvZWRpdG9yLW1lZGlhLXF1ZXJ5LWZvbGRlci1saXN0LmdxbCc7CmltcG9ydCBjcmVhdGVBc3NldEZvbGRlck11dGF0aW9uIGZyb20gJ2dxbC9lZGl0b3IvZWRpdG9yLW1lZGlhLW11dGF0aW9uLWZvbGRlci1jcmVhdGUuZ3FsJzsKaW1wb3J0IHJlbmFtZUFzc2V0TXV0YXRpb24gZnJvbSAnZ3FsL2VkaXRvci9lZGl0b3ItbWVkaWEtbXV0YXRpb24tYXNzZXQtcmVuYW1lLmdxbCc7CmltcG9ydCBkZWxldGVBc3NldE11dGF0aW9uIGZyb20gJ2dxbC9lZGl0b3IvZWRpdG9yLW1lZGlhLW11dGF0aW9uLWFzc2V0LWRlbGV0ZS5ncWwnOwpjb25zdCBGaWxlUG9uZCA9IHZ1ZUZpbGVQb25kKCk7CmNvbnN0IGxvY2FsZVNlZ21lbnRSZWdleCA9IC9eW0EtWl17Mn0oLVtBLVpdezJ9KT8kL2k7CmNvbnN0IGRpc2FsbG93ZWRGb2xkZXJDaGFycyA9IC9bQS1aKCk9LiFAIyQlPyYqK2B+PD4sOzpcXC9bXF3CrHt8IF0vOwpleHBvcnQgZGVmYXVsdCB7CiAgY29tcG9uZW50czogewogICAgRmlsZVBvbmQKICB9LAogIHByb3BzOiB7CiAgICB2YWx1ZTogewogICAgICB0eXBlOiBCb29sZWFuLAogICAgICBkZWZhdWx0OiBmYWxzZQogICAgfQogIH0sCgogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBmb2xkZXJzOiBbXSwKICAgICAgZmlsZXM6IFtdLAogICAgICBhc3NldHM6IFtdLAogICAgICBwYWdpbmF0aW9uOiAxLAogICAgICByZW1vdGVJbWFnZVVybDogJycsCiAgICAgIGltYWdlQWxpZ25tZW50czogW3sKICAgICAgICB0ZXh0OiAnTm9uZScsCiAgICAgICAgdmFsdWU6ICcnCiAgICAgIH0sIHsKICAgICAgICB0ZXh0OiAnTGVmdCcsCiAgICAgICAgdmFsdWU6ICdsZWZ0JwogICAgICB9LCB7CiAgICAgICAgdGV4dDogJ0NlbnRlcmVkJywKICAgICAgICB2YWx1ZTogJ2NlbnRlcicKICAgICAgfSwgewogICAgICAgIHRleHQ6ICdSaWdodCcsCiAgICAgICAgdmFsdWU6ICdyaWdodCcKICAgICAgfSwgewogICAgICAgIHRleHQ6ICdBYnNvbHV0ZSBUb3AgUmlnaHQnLAogICAgICAgIHZhbHVlOiAnYWJzdG9wcmlnaHQnCiAgICAgIH1dLAogICAgICBpbWFnZUFsaWdubWVudDogJycsCiAgICAgIGxvYWRpbmc6IGZhbHNlLAogICAgICBuZXdGb2xkZXJEaWFsb2c6IGZhbHNlLAogICAgICBuZXdGb2xkZXJOYW1lOiAnJywKICAgICAgbmV3Rm9sZGVyTG9hZGluZzogZmFsc2UsCiAgICAgIHByZXZpZXdEaWFsb2c6IGZhbHNlLAogICAgICByZW5hbWVEaWFsb2c6IGZhbHNlLAogICAgICByZW5hbWVBc3NldE5hbWU6ICcnLAogICAgICByZW5hbWVBc3NldExvYWRpbmc6IGZhbHNlLAogICAgICBkZWxldGVEaWFsb2c6IGZhbHNlLAogICAgICBkZWxldGVBc3NldExvYWRpbmc6IGZhbHNlCiAgICB9OwogIH0sCgogIGNvbXB1dGVkOiB7CiAgICBpc1Nob3duOiB7CiAgICAgIGdldCgpIHsKICAgICAgICByZXR1cm4gdGhpcy52YWx1ZTsKICAgICAgfSwKCiAgICAgIHNldCh2YWwpIHsKICAgICAgICB0aGlzLiRlbWl0KCdpbnB1dCcsIHZhbCk7CiAgICAgIH0KCiAgICB9LAogICAgZWRpdG9yS2V5OiBnZXQoJ2VkaXRvci9lZGl0b3JLZXknKSwKICAgIGFjdGl2ZU1vZGFsOiBzeW5jKCdlZGl0b3IvYWN0aXZlTW9kYWwnKSwKICAgIGZvbGRlclRyZWU6IGdldCgnZWRpdG9yL21lZGlhQGZvbGRlclRyZWUnKSwKICAgIGN1cnJlbnRGb2xkZXJJZDogc3luYygnZWRpdG9yL21lZGlhQGN1cnJlbnRGb2xkZXJJZCcpLAogICAgY3VycmVudEZpbGVJZDogc3luYygnZWRpdG9yL21lZGlhQGN1cnJlbnRGaWxlSWQnKSwKCiAgICBwYWdlVG90YWwoKSB7CiAgICAgIGlmICghdGhpcy5hc3NldHMpIHsKICAgICAgICByZXR1cm4gMDsKICAgICAgfQoKICAgICAgcmV0dXJuIE1hdGguY2VpbCh0aGlzLmFzc2V0cy5sZW5ndGggLyAxNSk7CiAgICB9LAoKICAgIGhlYWRlcnMoKSB7CiAgICAgIHJldHVybiBfY29tcGFjdChbdGhpcy4kdnVldGlmeS5icmVha3BvaW50LnNtQW5kVXAgJiYgewogICAgICAgIHRleHQ6IHRoaXMuJHQoJ2VkaXRvcjphc3NldHMuaGVhZGVySWQnKSwKICAgICAgICB2YWx1ZTogJ2lkJywKICAgICAgICB3aWR0aDogODAKICAgICAgfSwgewogICAgICAgIHRleHQ6IHRoaXMuJHQoJ2VkaXRvcjphc3NldHMuaGVhZGVyRmlsZW5hbWUnKSwKICAgICAgICB2YWx1ZTogJ2ZpbGVuYW1lJwogICAgICB9LCB0aGlzLiR2dWV0aWZ5LmJyZWFrcG9pbnQubGdBbmRVcCAmJiB7CiAgICAgICAgdGV4dDogdGhpcy4kdCgnZWRpdG9yOmFzc2V0cy5oZWFkZXJUeXBlJyksCiAgICAgICAgdmFsdWU6ICdleHQnLAogICAgICAgIHdpZHRoOiA5MAogICAgICB9LCB0aGlzLiR2dWV0aWZ5LmJyZWFrcG9pbnQubWRBbmRVcCAmJiB7CiAgICAgICAgdGV4dDogdGhpcy4kdCgnZWRpdG9yOmFzc2V0cy5oZWFkZXJGaWxlU2l6ZScpLAogICAgICAgIHZhbHVlOiAnZmlsZVNpemUnLAogICAgICAgIHdpZHRoOiAxMTAKICAgICAgfSwgdGhpcy4kdnVldGlmeS5icmVha3BvaW50Lm1kQW5kVXAgJiYgewogICAgICAgIHRleHQ6IHRoaXMuJHQoJ2VkaXRvcjphc3NldHMuaGVhZGVyQWRkZWQnKSwKICAgICAgICB2YWx1ZTogJ2NyZWF0ZWRBdCcsCiAgICAgICAgd2lkdGg6IDE3NQogICAgICB9LCB0aGlzLiR2dWV0aWZ5LmJyZWFrcG9pbnQuc21BbmRVcCAmJiB7CiAgICAgICAgdGV4dDogdGhpcy4kdCgnZWRpdG9yOmFzc2V0cy5oZWFkZXJBY3Rpb25zJyksCiAgICAgICAgdmFsdWU6ICcnLAogICAgICAgIHdpZHRoOiA4MCwKICAgICAgICBzb3J0YWJsZTogZmFsc2UsCiAgICAgICAgYWxpZ246ICdyaWdodCcKICAgICAgfV0pOwogICAgfSwKCiAgICBpc0ZvbGRlck5hbWVWYWxpZCgpIHsKICAgICAgcmV0dXJuIHRoaXMubmV3Rm9sZGVyTmFtZS5sZW5ndGggPiAxICYmICFsb2NhbGVTZWdtZW50UmVnZXgudGVzdCh0aGlzLm5ld0ZvbGRlck5hbWUpICYmICFkaXNhbGxvd2VkRm9sZGVyQ2hhcnMudGVzdCh0aGlzLm5ld0ZvbGRlck5hbWUpOwogICAgfSwKCiAgICBjdXJyZW50QXNzZXQoKSB7CiAgICAgIHJldHVybiBfZmluZCh0aGlzLmFzc2V0cywgWydpZCcsIHRoaXMuY3VycmVudEZpbGVJZF0pIHx8IHt9OwogICAgfSwKCiAgICBmaWxlUG9uZFNlcnZlck9wdHMoKSB7CiAgICAgIGNvbnN0IGp3dFRva2VuID0gQ29va2llcy5nZXQoJ2p3dCcpOwogICAgICByZXR1cm4gewogICAgICAgIHByb2Nlc3M6IHsKICAgICAgICAgIHVybDogJy91JywKICAgICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICAgJ0F1dGhvcml6YXRpb24nOiBgQmVhcmVyICR7and0VG9rZW59YAogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfTsKICAgIH0KCiAgfSwKICB3YXRjaDogewogICAgbmV3Rm9sZGVyRGlhbG9nKG5ld1ZhbHVlLCBvbGRWYWx1ZSkgewogICAgICBpZiAobmV3VmFsdWUpIHsKICAgICAgICB0aGlzLiRuZXh0VGljaygoKSA9PiB7CiAgICAgICAgICB0aGlzLiRyZWZzLmZvbGRlck5hbWVJcHQuZm9jdXMoKTsKICAgICAgICB9KTsKICAgICAgfQogICAgfQoKICB9LAogIGZpbHRlcnM6IHsKICAgIHByZXR0eUJ5dGVzKG51bSkgewogICAgICBpZiAodHlwZW9mIG51bSAhPT0gJ251bWJlcicgfHwgaXNOYU4obnVtKSkgewogICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0V4cGVjdGVkIGEgbnVtYmVyJyk7CiAgICAgIH0KCiAgICAgIGxldCBleHBvbmVudDsKICAgICAgbGV0IHVuaXQ7CiAgICAgIGxldCBuZWcgPSBudW0gPCAwOwogICAgICBsZXQgdW5pdHMgPSBbJ0InLCAna0InLCAnTUInLCAnR0InLCAnVEInLCAnUEInLCAnRUInLCAnWkInLCAnWUInXTsKCiAgICAgIGlmIChuZWcpIHsKICAgICAgICBudW0gPSAtbnVtOwogICAgICB9CgogICAgICBpZiAobnVtIDwgMSkgewogICAgICAgIHJldHVybiAobmVnID8gJy0nIDogJycpICsgbnVtICsgJyBCJzsKICAgICAgfQoKICAgICAgZXhwb25lbnQgPSBNYXRoLm1pbihNYXRoLmZsb29yKE1hdGgubG9nKG51bSkgLyBNYXRoLmxvZygxMDAwKSksIHVuaXRzLmxlbmd0aCAtIDEpOwogICAgICBudW0gPSAobnVtIC8gTWF0aC5wb3coMTAwMCwgZXhwb25lbnQpKS50b0ZpeGVkKDIpICogMTsKICAgICAgdW5pdCA9IHVuaXRzW2V4cG9uZW50XTsKICAgICAgcmV0dXJuIChuZWcgPyAnLScgOiAnJykgKyBudW0gKyAnICcgKyB1bml0OwogICAgfQoKICB9LAogIG1ldGhvZHM6IHsKICAgIGFzeW5jIHJlZnJlc2goKSB7CiAgICAgIGF3YWl0IHRoaXMuJGFwb2xsby5xdWVyaWVzLmFzc2V0cy5yZWZldGNoKCk7CiAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgnc2hvd05vdGlmaWNhdGlvbicsIHsKICAgICAgICBtZXNzYWdlOiB0aGlzLiR0KCdlZGl0b3I6YXNzZXRzLnJlZnJlc2hTdWNjZXNzJyksCiAgICAgICAgc3R5bGU6ICdzdWNjZXNzJywKICAgICAgICBpY29uOiAnY2hlY2snCiAgICAgIH0pOwogICAgfSwKCiAgICBpbnNlcnQoKSB7CiAgICAgIGNvbnN0IGFzc2V0ID0gX2ZpbmQodGhpcy5hc3NldHMsIFsnaWQnLCB0aGlzLmN1cnJlbnRGaWxlSWRdKTsKCiAgICAgIGNvbnN0IGFzc2V0UGF0aCA9IHRoaXMuZm9sZGVyVHJlZS5tYXAoZiA9PiBmLnNsdWcpLmpvaW4oJy8nKTsKICAgICAgdGhpcy4kcm9vdC4kZW1pdCgnZWRpdG9ySW5zZXJ0JywgewogICAgICAgIGtpbmQ6IGFzc2V0LmtpbmQsCiAgICAgICAgcGF0aDogdGhpcy5jdXJyZW50Rm9sZGVySWQgPiAwID8gYC8ke2Fzc2V0UGF0aH0vJHthc3NldC5maWxlbmFtZX1gIDogYC8ke2Fzc2V0LmZpbGVuYW1lfWAsCiAgICAgICAgdGV4dDogYXNzZXQuZmlsZW5hbWUsCiAgICAgICAgYWxpZ246IHRoaXMuaW1hZ2VBbGlnbm1lbnQKICAgICAgfSk7CiAgICAgIHRoaXMuYWN0aXZlTW9kYWwgPSAnJzsKICAgIH0sCgogICAgYnJvd3NlKCkgewogICAgICB0aGlzLiRyZWZzLnBvbmQuYnJvd3NlKCk7CiAgICB9LAoKICAgIGFzeW5jIHVwbG9hZCgpIHsKICAgICAgY29uc3QgZmlsZXMgPSB0aGlzLiRyZWZzLnBvbmQuZ2V0RmlsZXMoKTsKCiAgICAgIGlmIChmaWxlcy5sZW5ndGggPCAxKSB7CiAgICAgICAgcmV0dXJuIHRoaXMuJHN0b3JlLmNvbW1pdCgnc2hvd05vdGlmaWNhdGlvbicsIHsKICAgICAgICAgIG1lc3NhZ2U6IHRoaXMuJHQoJ2VkaXRvcjphc3NldHMubm9VcGxvYWRFcnJvcicpLAogICAgICAgICAgc3R5bGU6ICd3YXJuaW5nJywKICAgICAgICAgIGljb246ICd3YXJuaW5nJwogICAgICAgIH0pOwogICAgICB9CgogICAgICBmb3IgKGxldCBmaWxlIG9mIGZpbGVzKSB7CiAgICAgICAgZmlsZS5zZXRNZXRhZGF0YSh7CiAgICAgICAgICBmb2xkZXJJZDogdGhpcy5jdXJyZW50Rm9sZGVySWQKICAgICAgICB9KTsKICAgICAgfQoKICAgICAgYXdhaXQgdGhpcy4kcmVmcy5wb25kLnByb2Nlc3NGaWxlcygpOwogICAgfSwKCiAgICBhc3luYyBvbkZpbGVQcm9jZXNzZWQoZXJyLCBmaWxlKSB7CiAgICAgIGlmIChlcnIpIHsKICAgICAgICByZXR1cm4gdGhpcy4kc3RvcmUuY29tbWl0KCdzaG93Tm90aWZpY2F0aW9uJywgewogICAgICAgICAgbWVzc2FnZTogdGhpcy4kdCgnZWRpdG9yOmFzc2V0cy51cGxvYWRGYWlsZWQnKSwKICAgICAgICAgIHN0eWxlOiAnZXJyb3InLAogICAgICAgICAgaWNvbjogJ2Vycm9yJwogICAgICAgIH0pOwogICAgICB9CgogICAgICBfZGVsYXkoKCkgPT4gewogICAgICAgIHRoaXMuJHJlZnMucG9uZC5yZW1vdmVGaWxlKGZpbGUuaWQpOwogICAgICB9LCA1MDAwKTsKCiAgICAgIGF3YWl0IHRoaXMuJGFwb2xsby5xdWVyaWVzLmFzc2V0cy5yZWZldGNoKCk7CiAgICB9LAoKICAgIGRvd25Gb2xkZXIoZm9sZGVyKSB7CiAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgnZWRpdG9yL3B1c2hNZWRpYUZvbGRlclRyZWUnLCBmb2xkZXIpOwogICAgICB0aGlzLmN1cnJlbnRGb2xkZXJJZCA9IGZvbGRlci5pZDsKICAgICAgdGhpcy5jdXJyZW50RmlsZUlkID0gbnVsbDsKICAgIH0sCgogICAgdXBGb2xkZXIoKSB7CiAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgnZWRpdG9yL3BvcE1lZGlhRm9sZGVyVHJlZScpOwoKICAgICAgY29uc3QgcGFyZW50Rm9sZGVyID0gX2xhc3QodGhpcy5mb2xkZXJUcmVlKTsKCiAgICAgIHRoaXMuY3VycmVudEZvbGRlcklkID0gcGFyZW50Rm9sZGVyID8gcGFyZW50Rm9sZGVyLmlkIDogMDsKICAgICAgdGhpcy5jdXJyZW50RmlsZUlkID0gbnVsbDsKICAgIH0sCgogICAgYXN5bmMgY3JlYXRlRm9sZGVyKCkgewogICAgICB0aGlzLiRzdG9yZS5jb21taXQoYGxvYWRpbmdTdGFydGAsICdlZGl0b3ItbWVkaWEtY3JlYXRlZm9sZGVyJyk7CiAgICAgIHRoaXMubmV3Rm9sZGVyTG9hZGluZyA9IHRydWU7CgogICAgICB0cnkgewogICAgICAgIGNvbnN0IHJlc3AgPSBhd2FpdCB0aGlzLiRhcG9sbG8ubXV0YXRlKHsKICAgICAgICAgIG11dGF0aW9uOiBjcmVhdGVBc3NldEZvbGRlck11dGF0aW9uLAogICAgICAgICAgdmFyaWFibGVzOiB7CiAgICAgICAgICAgIHBhcmVudEZvbGRlcklkOiB0aGlzLmN1cnJlbnRGb2xkZXJJZCwKICAgICAgICAgICAgc2x1ZzogdGhpcy5uZXdGb2xkZXJOYW1lCiAgICAgICAgICB9CiAgICAgICAgfSk7CgogICAgICAgIGlmIChfZ2V0KHJlc3AsICdkYXRhLmFzc2V0cy5jcmVhdGVGb2xkZXIucmVzcG9uc2VSZXN1bHQuc3VjY2VlZGVkJywgZmFsc2UpKSB7CiAgICAgICAgICBhd2FpdCB0aGlzLiRhcG9sbG8ucXVlcmllcy5mb2xkZXJzLnJlZmV0Y2goKTsKICAgICAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgnc2hvd05vdGlmaWNhdGlvbicsIHsKICAgICAgICAgICAgbWVzc2FnZTogdGhpcy4kdCgnZWRpdG9yOmFzc2V0cy5mb2xkZXJDcmVhdGVTdWNjZXNzJyksCiAgICAgICAgICAgIHN0eWxlOiAnc3VjY2VzcycsCiAgICAgICAgICAgIGljb246ICdjaGVjaycKICAgICAgICAgIH0pOwogICAgICAgICAgdGhpcy5uZXdGb2xkZXJEaWFsb2cgPSBmYWxzZTsKICAgICAgICAgIHRoaXMubmV3Rm9sZGVyTmFtZSA9ICcnOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aGlzLiRzdG9yZS5jb21taXQoJ3B1c2hHcmFwaEVycm9yJywgbmV3IEVycm9yKF9nZXQocmVzcCwgJ2RhdGEuYXNzZXRzLmNyZWF0ZUZvbGRlci5yZXNwb25zZVJlc3VsdC5tZXNzYWdlJykpKTsKICAgICAgICB9CiAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgncHVzaEdyYXBoRXJyb3InLCBlcnIpOwogICAgICB9CgogICAgICB0aGlzLm5ld0ZvbGRlckxvYWRpbmcgPSBmYWxzZTsKICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KGBsb2FkaW5nU3RvcGAsICdlZGl0b3ItbWVkaWEtY3JlYXRlZm9sZGVyJyk7CiAgICB9LAoKICAgIG9wZW5SZW5hbWVEaWFsb2coKSB7CiAgICAgIHRoaXMucmVuYW1lQXNzZXROYW1lID0gdGhpcy5jdXJyZW50QXNzZXQuZmlsZW5hbWU7CiAgICAgIHRoaXMucmVuYW1lRGlhbG9nID0gdHJ1ZTsKICAgIH0sCgogICAgYXN5bmMgcmVuYW1lQXNzZXQoKSB7CiAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdChgbG9hZGluZ1N0YXJ0YCwgJ2VkaXRvci1tZWRpYS1yZW5hbWVhc3NldCcpOwogICAgICB0aGlzLnJlbmFtZUFzc2V0TG9hZGluZyA9IHRydWU7CgogICAgICB0cnkgewogICAgICAgIGNvbnN0IHJlc3AgPSBhd2FpdCB0aGlzLiRhcG9sbG8ubXV0YXRlKHsKICAgICAgICAgIG11dGF0aW9uOiByZW5hbWVBc3NldE11dGF0aW9uLAogICAgICAgICAgdmFyaWFibGVzOiB7CiAgICAgICAgICAgIGlkOiB0aGlzLmN1cnJlbnRGaWxlSWQsCiAgICAgICAgICAgIGZpbGVuYW1lOiB0aGlzLnJlbmFtZUFzc2V0TmFtZQogICAgICAgICAgfQogICAgICAgIH0pOwoKICAgICAgICBpZiAoX2dldChyZXNwLCAnZGF0YS5hc3NldHMucmVuYW1lQXNzZXQucmVzcG9uc2VSZXN1bHQuc3VjY2VlZGVkJywgZmFsc2UpKSB7CiAgICAgICAgICBhd2FpdCB0aGlzLiRhcG9sbG8ucXVlcmllcy5hc3NldHMucmVmZXRjaCgpOwogICAgICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCdzaG93Tm90aWZpY2F0aW9uJywgewogICAgICAgICAgICBtZXNzYWdlOiB0aGlzLiR0KCdlZGl0b3I6YXNzZXRzLnJlbmFtZVN1Y2Nlc3MnKSwKICAgICAgICAgICAgc3R5bGU6ICdzdWNjZXNzJywKICAgICAgICAgICAgaWNvbjogJ2NoZWNrJwogICAgICAgICAgfSk7CiAgICAgICAgICB0aGlzLnJlbmFtZURpYWxvZyA9IGZhbHNlOwogICAgICAgICAgdGhpcy5yZW5hbWVBc3NldE5hbWUgPSAnJzsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCdwdXNoR3JhcGhFcnJvcicsIG5ldyBFcnJvcihfZ2V0KHJlc3AsICdkYXRhLmFzc2V0cy5yZW5hbWVBc3NldC5yZXNwb25zZVJlc3VsdC5tZXNzYWdlJykpKTsKICAgICAgICB9CiAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgncHVzaEdyYXBoRXJyb3InLCBlcnIpOwogICAgICB9CgogICAgICB0aGlzLnJlbmFtZUFzc2V0TG9hZGluZyA9IGZhbHNlOwogICAgICB0aGlzLiRzdG9yZS5jb21taXQoYGxvYWRpbmdTdG9wYCwgJ2VkaXRvci1tZWRpYS1yZW5hbWVhc3NldCcpOwogICAgfSwKCiAgICBhc3luYyBkZWxldGVBc3NldCgpIHsKICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KGBsb2FkaW5nU3RhcnRgLCAnZWRpdG9yLW1lZGlhLWRlbGV0ZWFzc2V0Jyk7CiAgICAgIHRoaXMuZGVsZXRlQXNzZXRMb2FkaW5nID0gdHJ1ZTsKCiAgICAgIHRyeSB7CiAgICAgICAgY29uc3QgcmVzcCA9IGF3YWl0IHRoaXMuJGFwb2xsby5tdXRhdGUoewogICAgICAgICAgbXV0YXRpb246IGRlbGV0ZUFzc2V0TXV0YXRpb24sCiAgICAgICAgICB2YXJpYWJsZXM6IHsKICAgICAgICAgICAgaWQ6IHRoaXMuY3VycmVudEZpbGVJZAogICAgICAgICAgfQogICAgICAgIH0pOwoKICAgICAgICBpZiAoX2dldChyZXNwLCAnZGF0YS5hc3NldHMuZGVsZXRlQXNzZXQucmVzcG9uc2VSZXN1bHQuc3VjY2VlZGVkJywgZmFsc2UpKSB7CiAgICAgICAgICB0aGlzLmN1cnJlbnRGaWxlSWQgPSBudWxsOwogICAgICAgICAgYXdhaXQgdGhpcy4kYXBvbGxvLnF1ZXJpZXMuYXNzZXRzLnJlZmV0Y2goKTsKICAgICAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgnc2hvd05vdGlmaWNhdGlvbicsIHsKICAgICAgICAgICAgbWVzc2FnZTogdGhpcy4kdCgnZWRpdG9yOmFzc2V0cy5kZWxldGVTdWNjZXNzJyksCiAgICAgICAgICAgIHN0eWxlOiAnc3VjY2VzcycsCiAgICAgICAgICAgIGljb246ICdjaGVjaycKICAgICAgICAgIH0pOwogICAgICAgICAgdGhpcy5kZWxldGVEaWFsb2cgPSBmYWxzZTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCdwdXNoR3JhcGhFcnJvcicsIG5ldyBFcnJvcihfZ2V0KHJlc3AsICdkYXRhLmFzc2V0cy5kZWxldGVBc3NldC5yZXNwb25zZVJlc3VsdC5tZXNzYWdlJykpKTsKICAgICAgICB9CiAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgncHVzaEdyYXBoRXJyb3InLCBlcnIpOwogICAgICB9CgogICAgICB0aGlzLmRlbGV0ZUFzc2V0TG9hZGluZyA9IGZhbHNlOwogICAgICB0aGlzLiRzdG9yZS5jb21taXQoYGxvYWRpbmdTdG9wYCwgJ2VkaXRvci1tZWRpYS1kZWxldGVhc3NldCcpOwogICAgfSwKCiAgICBjYW5jZWwoKSB7CiAgICAgIHRoaXMuYWN0aXZlTW9kYWwgPSAnJzsKICAgIH0KCiAgfSwKICBhcG9sbG86IHsKICAgIGZvbGRlcnM6IHsKICAgICAgcXVlcnk6IGxpc3RGb2xkZXJBc3NldFF1ZXJ5LAoKICAgICAgdmFyaWFibGVzKCkgewogICAgICAgIHJldHVybiB7CiAgICAgICAgICBwYXJlbnRGb2xkZXJJZDogdGhpcy5jdXJyZW50Rm9sZGVySWQKICAgICAgICB9OwogICAgICB9LAoKICAgICAgZmV0Y2hQb2xpY3k6ICduZXR3b3JrLW9ubHknLAogICAgICB1cGRhdGU6IGRhdGEgPT4gZGF0YS5hc3NldHMuZm9sZGVycywKCiAgICAgIHdhdGNoTG9hZGluZyhpc0xvYWRpbmcpIHsKICAgICAgICB0aGlzLiRzdG9yZS5jb21taXQoYGxvYWRpbmcke2lzTG9hZGluZyA/ICdTdGFydCcgOiAnU3RvcCd9YCwgJ2VkaXRvci1tZWRpYS1mb2xkZXJzLWxpc3QtcmVmcmVzaCcpOwogICAgICB9CgogICAgfSwKICAgIGFzc2V0czogewogICAgICBxdWVyeTogbGlzdEFzc2V0UXVlcnksCgogICAgICB2YXJpYWJsZXMoKSB7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgIGZvbGRlcklkOiB0aGlzLmN1cnJlbnRGb2xkZXJJZCwKICAgICAgICAgIGtpbmQ6ICdBTEwnCiAgICAgICAgfTsKICAgICAgfSwKCiAgICAgIHRocm90dGxlOiAxMDAwLAogICAgICBmZXRjaFBvbGljeTogJ25ldHdvcmstb25seScsCiAgICAgIHVwZGF0ZTogZGF0YSA9PiBkYXRhLmFzc2V0cy5saXN0LAoKICAgICAgd2F0Y2hMb2FkaW5nKGlzTG9hZGluZykgewogICAgICAgIHRoaXMubG9hZGluZyA9IGlzTG9hZGluZzsKICAgICAgICB0aGlzLiRzdG9yZS5jb21taXQoYGxvYWRpbmcke2lzTG9hZGluZyA/ICdTdGFydCcgOiAnU3RvcCd9YCwgJ2VkaXRvci1tZWRpYS1saXN0LXJlZnJlc2gnKTsKICAgICAgfQoKICAgIH0KICB9Cn07"},null]}