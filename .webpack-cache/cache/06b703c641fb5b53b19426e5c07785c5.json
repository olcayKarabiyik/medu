{"remainingRequest":"/wiki/node_modules/babel-loader/lib/index.js??ref--0-1!/wiki/node_modules/vuetify/lib/components/VSelect/VSelect.js","dependencies":[{"path":"/wiki/node_modules/vuetify/lib/components/VSelect/VSelect.js","mtime":1716088148801},{"path":"/wiki/node_modules/cache-loader/dist/cjs.js","mtime":1716088090639},{"path":"/wiki/node_modules/babel-loader/lib/index.js","mtime":1716088089693}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8gU3R5bGVzCmltcG9ydCAiLi4vLi4vLi4vc3JjL2NvbXBvbmVudHMvVlRleHRGaWVsZC9WVGV4dEZpZWxkLnNhc3MiOwppbXBvcnQgIi4uLy4uLy4uL3NyYy9jb21wb25lbnRzL1ZTZWxlY3QvVlNlbGVjdC5zYXNzIjsgLy8gQ29tcG9uZW50cwoKaW1wb3J0IFZDaGlwIGZyb20gJy4uL1ZDaGlwJzsKaW1wb3J0IFZNZW51IGZyb20gJy4uL1ZNZW51JzsKaW1wb3J0IFZTZWxlY3RMaXN0IGZyb20gJy4vVlNlbGVjdExpc3QnOyAvLyBFeHRlbnNpb25zCgppbXBvcnQgVklucHV0IGZyb20gJy4uL1ZJbnB1dCc7CmltcG9ydCBWVGV4dEZpZWxkIGZyb20gJy4uL1ZUZXh0RmllbGQvVlRleHRGaWVsZCc7IC8vIE1peGlucwoKaW1wb3J0IENvbXBhcmFibGUgZnJvbSAnLi4vLi4vbWl4aW5zL2NvbXBhcmFibGUnOwppbXBvcnQgRGVwZW5kZW50IGZyb20gJy4uLy4uL21peGlucy9kZXBlbmRlbnQnOwppbXBvcnQgRmlsdGVyYWJsZSBmcm9tICcuLi8uLi9taXhpbnMvZmlsdGVyYWJsZSc7IC8vIERpcmVjdGl2ZXMKCmltcG9ydCBDbGlja091dHNpZGUgZnJvbSAnLi4vLi4vZGlyZWN0aXZlcy9jbGljay1vdXRzaWRlJzsgLy8gVXRpbGl0aWVzCgppbXBvcnQgbWVyZ2VEYXRhIGZyb20gJy4uLy4uL3V0aWwvbWVyZ2VEYXRhJzsKaW1wb3J0IHsgZ2V0UHJvcGVydHlGcm9tSXRlbSwgZ2V0T2JqZWN0VmFsdWVCeVBhdGgsIGtleUNvZGVzIH0gZnJvbSAnLi4vLi4vdXRpbC9oZWxwZXJzJzsKaW1wb3J0IHsgY29uc29sZUVycm9yIH0gZnJvbSAnLi4vLi4vdXRpbC9jb25zb2xlJzsgLy8gVHlwZXMKCmltcG9ydCBtaXhpbnMgZnJvbSAnLi4vLi4vdXRpbC9taXhpbnMnOwpleHBvcnQgY29uc3QgZGVmYXVsdE1lbnVQcm9wcyA9IHsKICBjbG9zZU9uQ2xpY2s6IGZhbHNlLAogIGNsb3NlT25Db250ZW50Q2xpY2s6IGZhbHNlLAogIGRpc2FibGVLZXlzOiB0cnVlLAogIG9wZW5PbkNsaWNrOiBmYWxzZSwKICBtYXhIZWlnaHQ6IDMwNAp9OyAvLyBUeXBlcwoKY29uc3QgYmFzZU1peGlucyA9IG1peGlucyhWVGV4dEZpZWxkLCBDb21wYXJhYmxlLCBEZXBlbmRlbnQsIEZpbHRlcmFibGUpOwovKiBAdnVlL2NvbXBvbmVudCAqLwoKZXhwb3J0IGRlZmF1bHQgYmFzZU1peGlucy5leHRlbmQoKS5leHRlbmQoewogIG5hbWU6ICd2LXNlbGVjdCcsCiAgZGlyZWN0aXZlczogewogICAgQ2xpY2tPdXRzaWRlCiAgfSwKICBwcm9wczogewogICAgYXBwZW5kSWNvbjogewogICAgICB0eXBlOiBTdHJpbmcsCiAgICAgIGRlZmF1bHQ6ICckZHJvcGRvd24nCiAgICB9LAogICAgYXR0YWNoOiB7CiAgICAgIHR5cGU6IG51bGwsCiAgICAgIGRlZmF1bHQ6IGZhbHNlCiAgICB9LAogICAgY2FjaGVJdGVtczogQm9vbGVhbiwKICAgIGNoaXBzOiBCb29sZWFuLAogICAgY2xlYXJhYmxlOiBCb29sZWFuLAogICAgZGVsZXRhYmxlQ2hpcHM6IEJvb2xlYW4sCiAgICBkaXNhYmxlTG9va3VwOiBCb29sZWFuLAogICAgZWFnZXI6IEJvb2xlYW4sCiAgICBoaWRlU2VsZWN0ZWQ6IEJvb2xlYW4sCiAgICBpdGVtczogewogICAgICB0eXBlOiBBcnJheSwKICAgICAgZGVmYXVsdDogKCkgPT4gW10KICAgIH0sCiAgICBpdGVtQ29sb3I6IHsKICAgICAgdHlwZTogU3RyaW5nLAogICAgICBkZWZhdWx0OiAncHJpbWFyeScKICAgIH0sCiAgICBpdGVtRGlzYWJsZWQ6IHsKICAgICAgdHlwZTogW1N0cmluZywgQXJyYXksIEZ1bmN0aW9uXSwKICAgICAgZGVmYXVsdDogJ2Rpc2FibGVkJwogICAgfSwKICAgIGl0ZW1UZXh0OiB7CiAgICAgIHR5cGU6IFtTdHJpbmcsIEFycmF5LCBGdW5jdGlvbl0sCiAgICAgIGRlZmF1bHQ6ICd0ZXh0JwogICAgfSwKICAgIGl0ZW1WYWx1ZTogewogICAgICB0eXBlOiBbU3RyaW5nLCBBcnJheSwgRnVuY3Rpb25dLAogICAgICBkZWZhdWx0OiAndmFsdWUnCiAgICB9LAogICAgbWVudVByb3BzOiB7CiAgICAgIHR5cGU6IFtTdHJpbmcsIEFycmF5LCBPYmplY3RdLAogICAgICBkZWZhdWx0OiAoKSA9PiBkZWZhdWx0TWVudVByb3BzCiAgICB9LAogICAgbXVsdGlwbGU6IEJvb2xlYW4sCiAgICBvcGVuT25DbGVhcjogQm9vbGVhbiwKICAgIHJldHVybk9iamVjdDogQm9vbGVhbiwKICAgIHNtYWxsQ2hpcHM6IEJvb2xlYW4KICB9LAoKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgY2FjaGVkSXRlbXM6IHRoaXMuY2FjaGVJdGVtcyA/IHRoaXMuaXRlbXMgOiBbXSwKICAgICAgbWVudUlzQm9vdGVkOiBmYWxzZSwKICAgICAgaXNNZW51QWN0aXZlOiBmYWxzZSwKICAgICAgbGFzdEl0ZW06IDIwLAogICAgICAvLyBBcyBsb25nIGFzIGEgdmFsdWUgaXMgZGVmaW5lZCwgc2hvdyBpdAogICAgICAvLyBPdGhlcndpc2UsIGNoZWNrIGlmIG11bHRpcGxlCiAgICAgIC8vIHRvIGRldGVybWluZSB3aGljaCBkZWZhdWx0IHRvIHByb3ZpZGUKICAgICAgbGF6eVZhbHVlOiB0aGlzLnZhbHVlICE9PSB1bmRlZmluZWQgPyB0aGlzLnZhbHVlIDogdGhpcy5tdWx0aXBsZSA/IFtdIDogdW5kZWZpbmVkLAogICAgICBzZWxlY3RlZEluZGV4OiAtMSwKICAgICAgc2VsZWN0ZWRJdGVtczogW10sCiAgICAgIGtleWJvYXJkTG9va3VwUHJlZml4OiAnJywKICAgICAga2V5Ym9hcmRMb29rdXBMYXN0VGltZTogMAogICAgfTsKICB9LAoKICBjb21wdXRlZDogewogICAgLyogQWxsIGl0ZW1zIHRoYXQgdGhlIHNlbGVjdCBoYXMgKi8KICAgIGFsbEl0ZW1zKCkgewogICAgICByZXR1cm4gdGhpcy5maWx0ZXJEdXBsaWNhdGVzKHRoaXMuY2FjaGVkSXRlbXMuY29uY2F0KHRoaXMuaXRlbXMpKTsKICAgIH0sCgogICAgY2xhc3NlcygpIHsKICAgICAgcmV0dXJuIHsgLi4uVlRleHRGaWVsZC5vcHRpb25zLmNvbXB1dGVkLmNsYXNzZXMuY2FsbCh0aGlzKSwKICAgICAgICAndi1zZWxlY3QnOiB0cnVlLAogICAgICAgICd2LXNlbGVjdC0tY2hpcHMnOiB0aGlzLmhhc0NoaXBzLAogICAgICAgICd2LXNlbGVjdC0tY2hpcHMtLXNtYWxsJzogdGhpcy5zbWFsbENoaXBzLAogICAgICAgICd2LXNlbGVjdC0taXMtbWVudS1hY3RpdmUnOiB0aGlzLmlzTWVudUFjdGl2ZSwKICAgICAgICAndi1zZWxlY3QtLWlzLW11bHRpJzogdGhpcy5tdWx0aXBsZQogICAgICB9OwogICAgfSwKCiAgICAvKiBVc2VkIGJ5IG90aGVyIGNvbXBvbmVudHMgdG8gb3ZlcndyaXRlICovCiAgICBjb21wdXRlZEl0ZW1zKCkgewogICAgICByZXR1cm4gdGhpcy5hbGxJdGVtczsKICAgIH0sCgogICAgY29tcHV0ZWRPd25zKCkgewogICAgICByZXR1cm4gYGxpc3QtJHt0aGlzLl91aWR9YDsKICAgIH0sCgogICAgY29tcHV0ZWRDb3VudGVyVmFsdWUoKSB7CiAgICAgIHJldHVybiB0aGlzLm11bHRpcGxlID8gdGhpcy5zZWxlY3RlZEl0ZW1zLmxlbmd0aCA6ICh0aGlzLmdldFRleHQodGhpcy5zZWxlY3RlZEl0ZW1zWzBdKSB8fCAnJykudG9TdHJpbmcoKS5sZW5ndGg7CiAgICB9LAoKICAgIGRpcmVjdGl2ZXMoKSB7CiAgICAgIHJldHVybiB0aGlzLmlzRm9jdXNlZCA/IFt7CiAgICAgICAgbmFtZTogJ2NsaWNrLW91dHNpZGUnLAogICAgICAgIHZhbHVlOiB7CiAgICAgICAgICBoYW5kbGVyOiB0aGlzLmJsdXIsCiAgICAgICAgICBjbG9zZUNvbmRpdGlvbmFsOiB0aGlzLmNsb3NlQ29uZGl0aW9uYWwsCiAgICAgICAgICBpbmNsdWRlOiAoKSA9PiB0aGlzLmdldE9wZW5EZXBlbmRlbnRFbGVtZW50cygpCiAgICAgICAgfQogICAgICB9XSA6IHVuZGVmaW5lZDsKICAgIH0sCgogICAgZHluYW1pY0hlaWdodCgpIHsKICAgICAgcmV0dXJuICdhdXRvJzsKICAgIH0sCgogICAgaGFzQ2hpcHMoKSB7CiAgICAgIHJldHVybiB0aGlzLmNoaXBzIHx8IHRoaXMuc21hbGxDaGlwczsKICAgIH0sCgogICAgaGFzU2xvdCgpIHsKICAgICAgcmV0dXJuIEJvb2xlYW4odGhpcy5oYXNDaGlwcyB8fCB0aGlzLiRzY29wZWRTbG90cy5zZWxlY3Rpb24pOwogICAgfSwKCiAgICBpc0RpcnR5KCkgewogICAgICByZXR1cm4gdGhpcy5zZWxlY3RlZEl0ZW1zLmxlbmd0aCA+IDA7CiAgICB9LAoKICAgIGxpc3REYXRhKCkgewogICAgICBjb25zdCBzY29wZUlkID0gdGhpcy4kdm5vZGUgJiYgdGhpcy4kdm5vZGUuY29udGV4dC4kb3B0aW9ucy5fc2NvcGVJZDsKICAgICAgY29uc3QgYXR0cnMgPSBzY29wZUlkID8gewogICAgICAgIFtzY29wZUlkXTogdHJ1ZQogICAgICB9IDoge307CiAgICAgIHJldHVybiB7CiAgICAgICAgYXR0cnM6IHsgLi4uYXR0cnMsCiAgICAgICAgICBpZDogdGhpcy5jb21wdXRlZE93bnMKICAgICAgICB9LAogICAgICAgIHByb3BzOiB7CiAgICAgICAgICBhY3Rpb246IHRoaXMubXVsdGlwbGUsCiAgICAgICAgICBjb2xvcjogdGhpcy5pdGVtQ29sb3IsCiAgICAgICAgICBkZW5zZTogdGhpcy5kZW5zZSwKICAgICAgICAgIGhpZGVTZWxlY3RlZDogdGhpcy5oaWRlU2VsZWN0ZWQsCiAgICAgICAgICBpdGVtczogdGhpcy52aXJ0dWFsaXplZEl0ZW1zLAogICAgICAgICAgaXRlbURpc2FibGVkOiB0aGlzLml0ZW1EaXNhYmxlZCwKICAgICAgICAgIGl0ZW1UZXh0OiB0aGlzLml0ZW1UZXh0LAogICAgICAgICAgaXRlbVZhbHVlOiB0aGlzLml0ZW1WYWx1ZSwKICAgICAgICAgIG5vRGF0YVRleHQ6IHRoaXMuJHZ1ZXRpZnkubGFuZy50KHRoaXMubm9EYXRhVGV4dCksCiAgICAgICAgICBzZWxlY3RlZEl0ZW1zOiB0aGlzLnNlbGVjdGVkSXRlbXMKICAgICAgICB9LAogICAgICAgIG9uOiB7CiAgICAgICAgICBzZWxlY3Q6IHRoaXMuc2VsZWN0SXRlbQogICAgICAgIH0sCiAgICAgICAgc2NvcGVkU2xvdHM6IHsKICAgICAgICAgIGl0ZW06IHRoaXMuJHNjb3BlZFNsb3RzLml0ZW0KICAgICAgICB9CiAgICAgIH07CiAgICB9LAoKICAgIHN0YXRpY0xpc3QoKSB7CiAgICAgIGlmICh0aGlzLiRzbG90c1snbm8tZGF0YSddIHx8IHRoaXMuJHNsb3RzWydwcmVwZW5kLWl0ZW0nXSB8fCB0aGlzLiRzbG90c1snYXBwZW5kLWl0ZW0nXSkgewogICAgICAgIGNvbnNvbGVFcnJvcignYXNzZXJ0OiBzdGF0aWNMaXN0IHNob3VsZCBub3QgYmUgY2FsbGVkIGlmIHNsb3RzIGFyZSB1c2VkJyk7CiAgICAgIH0KCiAgICAgIHJldHVybiB0aGlzLiRjcmVhdGVFbGVtZW50KFZTZWxlY3RMaXN0LCB0aGlzLmxpc3REYXRhKTsKICAgIH0sCgogICAgdmlydHVhbGl6ZWRJdGVtcygpIHsKICAgICAgcmV0dXJuIHRoaXMuJF9tZW51UHJvcHMuYXV0byA/IHRoaXMuY29tcHV0ZWRJdGVtcyA6IHRoaXMuY29tcHV0ZWRJdGVtcy5zbGljZSgwLCB0aGlzLmxhc3RJdGVtKTsKICAgIH0sCgogICAgbWVudUNhblNob3c6ICgpID0+IHRydWUsCgogICAgJF9tZW51UHJvcHMoKSB7CiAgICAgIGxldCBub3JtYWxpc2VkUHJvcHMgPSB0eXBlb2YgdGhpcy5tZW51UHJvcHMgPT09ICdzdHJpbmcnID8gdGhpcy5tZW51UHJvcHMuc3BsaXQoJywnKSA6IHRoaXMubWVudVByb3BzOwoKICAgICAgaWYgKEFycmF5LmlzQXJyYXkobm9ybWFsaXNlZFByb3BzKSkgewogICAgICAgIG5vcm1hbGlzZWRQcm9wcyA9IG5vcm1hbGlzZWRQcm9wcy5yZWR1Y2UoKGFjYywgcCkgPT4gewogICAgICAgICAgYWNjW3AudHJpbSgpXSA9IHRydWU7CiAgICAgICAgICByZXR1cm4gYWNjOwogICAgICAgIH0sIHt9KTsKICAgICAgfQoKICAgICAgcmV0dXJuIHsgLi4uZGVmYXVsdE1lbnVQcm9wcywKICAgICAgICBlYWdlcjogdGhpcy5lYWdlciwKICAgICAgICB2YWx1ZTogdGhpcy5tZW51Q2FuU2hvdyAmJiB0aGlzLmlzTWVudUFjdGl2ZSwKICAgICAgICBudWRnZUJvdHRvbTogbm9ybWFsaXNlZFByb3BzLm9mZnNldFkgPyAxIDogMCwKICAgICAgICAuLi5ub3JtYWxpc2VkUHJvcHMKICAgICAgfTsKICAgIH0KCiAgfSwKICB3YXRjaDogewogICAgaW50ZXJuYWxWYWx1ZSh2YWwpIHsKICAgICAgdGhpcy5pbml0aWFsVmFsdWUgPSB2YWw7CiAgICAgIHRoaXMuc2V0U2VsZWN0ZWRJdGVtcygpOwogICAgfSwKCiAgICBpc01lbnVBY3RpdmUodmFsKSB7CiAgICAgIHdpbmRvdy5zZXRUaW1lb3V0KCgpID0+IHRoaXMub25NZW51QWN0aXZlQ2hhbmdlKHZhbCkpOwogICAgfSwKCiAgICBpdGVtczogewogICAgICBpbW1lZGlhdGU6IHRydWUsCgogICAgICBoYW5kbGVyKHZhbCkgewogICAgICAgIGlmICh0aGlzLmNhY2hlSXRlbXMpIHsKICAgICAgICAgIC8vIEJyZWFrcyB2dWUtdGVzdC11dGlscyBpZgogICAgICAgICAgLy8gdGhpcyBpc24ndCBjYWxjdWxhdGVkCiAgICAgICAgICAvLyBvbiB0aGUgbmV4dCB0aWNrCiAgICAgICAgICB0aGlzLiRuZXh0VGljaygoKSA9PiB7CiAgICAgICAgICAgIHRoaXMuY2FjaGVkSXRlbXMgPSB0aGlzLmZpbHRlckR1cGxpY2F0ZXModGhpcy5jYWNoZWRJdGVtcy5jb25jYXQodmFsKSk7CiAgICAgICAgICB9KTsKICAgICAgICB9CgogICAgICAgIHRoaXMuc2V0U2VsZWN0ZWRJdGVtcygpOwogICAgICB9CgogICAgfQogIH0sCiAgbWV0aG9kczogewogICAgLyoqIEBwdWJsaWMgKi8KICAgIGJsdXIoZSkgewogICAgICBWVGV4dEZpZWxkLm9wdGlvbnMubWV0aG9kcy5ibHVyLmNhbGwodGhpcywgZSk7CiAgICAgIHRoaXMuaXNNZW51QWN0aXZlID0gZmFsc2U7CiAgICAgIHRoaXMuaXNGb2N1c2VkID0gZmFsc2U7CiAgICAgIHRoaXMuc2VsZWN0ZWRJbmRleCA9IC0xOwogICAgfSwKCiAgICAvKiogQHB1YmxpYyAqLwogICAgYWN0aXZhdGVNZW51KCkgewogICAgICBpZiAoIXRoaXMuaXNJbnRlcmFjdGl2ZSB8fCB0aGlzLmlzTWVudUFjdGl2ZSkgcmV0dXJuOwogICAgICB0aGlzLmlzTWVudUFjdGl2ZSA9IHRydWU7CiAgICB9LAoKICAgIGNsZWFyYWJsZUNhbGxiYWNrKCkgewogICAgICB0aGlzLnNldFZhbHVlKHRoaXMubXVsdGlwbGUgPyBbXSA6IHVuZGVmaW5lZCk7CiAgICAgIHRoaXMuc2V0TWVudUluZGV4KC0xKTsKICAgICAgdGhpcy4kbmV4dFRpY2soKCkgPT4gdGhpcy4kcmVmcy5pbnB1dCAmJiB0aGlzLiRyZWZzLmlucHV0LmZvY3VzKCkpOwogICAgICBpZiAodGhpcy5vcGVuT25DbGVhcikgdGhpcy5pc01lbnVBY3RpdmUgPSB0cnVlOwogICAgfSwKCiAgICBjbG9zZUNvbmRpdGlvbmFsKGUpIHsKICAgICAgaWYgKCF0aGlzLmlzTWVudUFjdGl2ZSkgcmV0dXJuIHRydWU7CiAgICAgIHJldHVybiAhdGhpcy5faXNEZXN0cm95ZWQgJiYgKCAvLyBDbGljayBvcmlnaW5hdGVzIGZyb20gb3V0c2lkZSB0aGUgbWVudSBjb250ZW50CiAgICAgIC8vIE11bHRpcGxlIHNlbGVjdHMgZG9uJ3QgY2xvc2Ugd2hlbiBhbiBpdGVtIGlzIGNsaWNrZWQKICAgICAgIXRoaXMuZ2V0Q29udGVudCgpIHx8ICF0aGlzLmdldENvbnRlbnQoKS5jb250YWlucyhlLnRhcmdldCkpICYmIC8vIENsaWNrIG9yaWdpbmF0ZXMgZnJvbSBvdXRzaWRlIHRoZSBlbGVtZW50CiAgICAgIHRoaXMuJGVsICYmICF0aGlzLiRlbC5jb250YWlucyhlLnRhcmdldCkgJiYgZS50YXJnZXQgIT09IHRoaXMuJGVsOwogICAgfSwKCiAgICBmaWx0ZXJEdXBsaWNhdGVzKGFycikgewogICAgICBjb25zdCB1bmlxdWVWYWx1ZXMgPSBuZXcgTWFwKCk7CgogICAgICBmb3IgKGxldCBpbmRleCA9IDA7IGluZGV4IDwgYXJyLmxlbmd0aDsgKytpbmRleCkgewogICAgICAgIGNvbnN0IGl0ZW0gPSBhcnJbaW5kZXhdOwogICAgICAgIGNvbnN0IHZhbCA9IHRoaXMuZ2V0VmFsdWUoaXRlbSk7IC8vIFRPRE86IGNvbXBhcmF0b3IKCiAgICAgICAgIXVuaXF1ZVZhbHVlcy5oYXModmFsKSAmJiB1bmlxdWVWYWx1ZXMuc2V0KHZhbCwgaXRlbSk7CiAgICAgIH0KCiAgICAgIHJldHVybiBBcnJheS5mcm9tKHVuaXF1ZVZhbHVlcy52YWx1ZXMoKSk7CiAgICB9LAoKICAgIGZpbmRFeGlzdGluZ0luZGV4KGl0ZW0pIHsKICAgICAgY29uc3QgaXRlbVZhbHVlID0gdGhpcy5nZXRWYWx1ZShpdGVtKTsKICAgICAgcmV0dXJuICh0aGlzLmludGVybmFsVmFsdWUgfHwgW10pLmZpbmRJbmRleChpID0+IHRoaXMudmFsdWVDb21wYXJhdG9yKHRoaXMuZ2V0VmFsdWUoaSksIGl0ZW1WYWx1ZSkpOwogICAgfSwKCiAgICBnZXRDb250ZW50KCkgewogICAgICByZXR1cm4gdGhpcy4kcmVmcy5tZW51ICYmIHRoaXMuJHJlZnMubWVudS4kcmVmcy5jb250ZW50OwogICAgfSwKCiAgICBnZW5DaGlwU2VsZWN0aW9uKGl0ZW0sIGluZGV4KSB7CiAgICAgIGNvbnN0IGlzRGlzYWJsZWQgPSAhdGhpcy5pc0ludGVyYWN0aXZlIHx8IHRoaXMuZ2V0RGlzYWJsZWQoaXRlbSk7CiAgICAgIHJldHVybiB0aGlzLiRjcmVhdGVFbGVtZW50KFZDaGlwLCB7CiAgICAgICAgc3RhdGljQ2xhc3M6ICd2LWNoaXAtLXNlbGVjdCcsCiAgICAgICAgYXR0cnM6IHsKICAgICAgICAgIHRhYmluZGV4OiAtMQogICAgICAgIH0sCiAgICAgICAgcHJvcHM6IHsKICAgICAgICAgIGNsb3NlOiB0aGlzLmRlbGV0YWJsZUNoaXBzICYmICFpc0Rpc2FibGVkLAogICAgICAgICAgZGlzYWJsZWQ6IGlzRGlzYWJsZWQsCiAgICAgICAgICBpbnB1dFZhbHVlOiBpbmRleCA9PT0gdGhpcy5zZWxlY3RlZEluZGV4LAogICAgICAgICAgc21hbGw6IHRoaXMuc21hbGxDaGlwcwogICAgICAgIH0sCiAgICAgICAgb246IHsKICAgICAgICAgIGNsaWNrOiBlID0+IHsKICAgICAgICAgICAgaWYgKGlzRGlzYWJsZWQpIHJldHVybjsKICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTsKICAgICAgICAgICAgdGhpcy5zZWxlY3RlZEluZGV4ID0gaW5kZXg7CiAgICAgICAgICB9LAogICAgICAgICAgJ2NsaWNrOmNsb3NlJzogKCkgPT4gdGhpcy5vbkNoaXBJbnB1dChpdGVtKQogICAgICAgIH0sCiAgICAgICAga2V5OiBKU09OLnN0cmluZ2lmeSh0aGlzLmdldFZhbHVlKGl0ZW0pKQogICAgICB9LCB0aGlzLmdldFRleHQoaXRlbSkpOwogICAgfSwKCiAgICBnZW5Db21tYVNlbGVjdGlvbihpdGVtLCBpbmRleCwgbGFzdCkgewogICAgICBjb25zdCBjb2xvciA9IGluZGV4ID09PSB0aGlzLnNlbGVjdGVkSW5kZXggJiYgdGhpcy5jb21wdXRlZENvbG9yOwogICAgICBjb25zdCBpc0Rpc2FibGVkID0gIXRoaXMuaXNJbnRlcmFjdGl2ZSB8fCB0aGlzLmdldERpc2FibGVkKGl0ZW0pOwogICAgICByZXR1cm4gdGhpcy4kY3JlYXRlRWxlbWVudCgnZGl2JywgdGhpcy5zZXRUZXh0Q29sb3IoY29sb3IsIHsKICAgICAgICBzdGF0aWNDbGFzczogJ3Ytc2VsZWN0X19zZWxlY3Rpb24gdi1zZWxlY3RfX3NlbGVjdGlvbi0tY29tbWEnLAogICAgICAgIGNsYXNzOiB7CiAgICAgICAgICAndi1zZWxlY3RfX3NlbGVjdGlvbi0tZGlzYWJsZWQnOiBpc0Rpc2FibGVkCiAgICAgICAgfSwKICAgICAgICBrZXk6IEpTT04uc3RyaW5naWZ5KHRoaXMuZ2V0VmFsdWUoaXRlbSkpCiAgICAgIH0pLCBgJHt0aGlzLmdldFRleHQoaXRlbSl9JHtsYXN0ID8gJycgOiAnLCAnfWApOwogICAgfSwKCiAgICBnZW5EZWZhdWx0U2xvdCgpIHsKICAgICAgY29uc3Qgc2VsZWN0aW9ucyA9IHRoaXMuZ2VuU2VsZWN0aW9ucygpOwogICAgICBjb25zdCBpbnB1dCA9IHRoaXMuZ2VuSW5wdXQoKTsgLy8gSWYgdGhlIHJldHVybiBpcyBhbiBlbXB0eSBhcnJheQogICAgICAvLyBwdXNoIHRoZSBpbnB1dAoKICAgICAgaWYgKEFycmF5LmlzQXJyYXkoc2VsZWN0aW9ucykpIHsKICAgICAgICBzZWxlY3Rpb25zLnB1c2goaW5wdXQpOyAvLyBPdGhlcndpc2UgcHVzaCBpdCBpbnRvIGNoaWxkcmVuCiAgICAgIH0gZWxzZSB7CiAgICAgICAgc2VsZWN0aW9ucy5jaGlsZHJlbiA9IHNlbGVjdGlvbnMuY2hpbGRyZW4gfHwgW107CiAgICAgICAgc2VsZWN0aW9ucy5jaGlsZHJlbi5wdXNoKGlucHV0KTsKICAgICAgfQoKICAgICAgcmV0dXJuIFt0aGlzLmdlbkZpZWxkc2V0KCksIHRoaXMuJGNyZWF0ZUVsZW1lbnQoJ2RpdicsIHsKICAgICAgICBzdGF0aWNDbGFzczogJ3Ytc2VsZWN0X19zbG90JywKICAgICAgICBkaXJlY3RpdmVzOiB0aGlzLmRpcmVjdGl2ZXMKICAgICAgfSwgW3RoaXMuZ2VuTGFiZWwoKSwgdGhpcy5wcmVmaXggPyB0aGlzLmdlbkFmZml4KCdwcmVmaXgnKSA6IG51bGwsIHNlbGVjdGlvbnMsIHRoaXMuc3VmZml4ID8gdGhpcy5nZW5BZmZpeCgnc3VmZml4JykgOiBudWxsLCB0aGlzLmdlbkNsZWFySWNvbigpLCB0aGlzLmdlbkljb25TbG90KCksIHRoaXMuZ2VuSGlkZGVuSW5wdXQoKV0pLCB0aGlzLmdlbk1lbnUoKSwgdGhpcy5nZW5Qcm9ncmVzcygpXTsKICAgIH0sCgogICAgZ2VuSWNvbih0eXBlLCBjYiwgZXh0cmFEYXRhKSB7CiAgICAgIGNvbnN0IGljb24gPSBWSW5wdXQub3B0aW9ucy5tZXRob2RzLmdlbkljb24uY2FsbCh0aGlzLCB0eXBlLCBjYiwgZXh0cmFEYXRhKTsKCiAgICAgIGlmICh0eXBlID09PSAnYXBwZW5kJykgewogICAgICAgIC8vIERvbid0IGFsbG93IHRoZSBkcm9wZG93biBpY29uIHRvIGJlIGZvY3VzZWQKICAgICAgICBpY29uLmNoaWxkcmVuWzBdLmRhdGEgPSBtZXJnZURhdGEoaWNvbi5jaGlsZHJlblswXS5kYXRhLCB7CiAgICAgICAgICBhdHRyczogewogICAgICAgICAgICB0YWJpbmRleDogaWNvbi5jaGlsZHJlblswXS5jb21wb25lbnRPcHRpb25zLmxpc3RlbmVycyAmJiAnLTEnLAogICAgICAgICAgICAnYXJpYS1oaWRkZW4nOiAndHJ1ZScsCiAgICAgICAgICAgICdhcmlhLWxhYmVsJzogdW5kZWZpbmVkCiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIHJldHVybiBpY29uOwogICAgfSwKCiAgICBnZW5JbnB1dCgpIHsKICAgICAgY29uc3QgaW5wdXQgPSBWVGV4dEZpZWxkLm9wdGlvbnMubWV0aG9kcy5nZW5JbnB1dC5jYWxsKHRoaXMpOwogICAgICBkZWxldGUgaW5wdXQuZGF0YS5hdHRycy5uYW1lOwogICAgICBpbnB1dC5kYXRhID0gbWVyZ2VEYXRhKGlucHV0LmRhdGEsIHsKICAgICAgICBkb21Qcm9wczogewogICAgICAgICAgdmFsdWU6IG51bGwKICAgICAgICB9LAogICAgICAgIGF0dHJzOiB7CiAgICAgICAgICByZWFkb25seTogdHJ1ZSwKICAgICAgICAgIHR5cGU6ICd0ZXh0JywKICAgICAgICAgICdhcmlhLXJlYWRvbmx5JzogU3RyaW5nKHRoaXMuaXNSZWFkb25seSksCiAgICAgICAgICAnYXJpYS1hY3RpdmVkZXNjZW5kYW50JzogZ2V0T2JqZWN0VmFsdWVCeVBhdGgodGhpcy4kcmVmcy5tZW51LCAnYWN0aXZlVGlsZS5pZCcpLAogICAgICAgICAgYXV0b2NvbXBsZXRlOiBnZXRPYmplY3RWYWx1ZUJ5UGF0aChpbnB1dC5kYXRhLCAnYXR0cnMuYXV0b2NvbXBsZXRlJywgJ29mZicpCiAgICAgICAgfSwKICAgICAgICBvbjogewogICAgICAgICAga2V5cHJlc3M6IHRoaXMub25LZXlQcmVzcwogICAgICAgIH0KICAgICAgfSk7CiAgICAgIHJldHVybiBpbnB1dDsKICAgIH0sCgogICAgZ2VuSGlkZGVuSW5wdXQoKSB7CiAgICAgIHJldHVybiB0aGlzLiRjcmVhdGVFbGVtZW50KCdpbnB1dCcsIHsKICAgICAgICBkb21Qcm9wczogewogICAgICAgICAgdmFsdWU6IHRoaXMubGF6eVZhbHVlCiAgICAgICAgfSwKICAgICAgICBhdHRyczogewogICAgICAgICAgdHlwZTogJ2hpZGRlbicsCiAgICAgICAgICBuYW1lOiB0aGlzLmF0dHJzJC5uYW1lCiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCgogICAgZ2VuSW5wdXRTbG90KCkgewogICAgICBjb25zdCByZW5kZXIgPSBWVGV4dEZpZWxkLm9wdGlvbnMubWV0aG9kcy5nZW5JbnB1dFNsb3QuY2FsbCh0aGlzKTsKICAgICAgcmVuZGVyLmRhdGEuYXR0cnMgPSB7IC4uLnJlbmRlci5kYXRhLmF0dHJzLAogICAgICAgIHJvbGU6ICdidXR0b24nLAogICAgICAgICdhcmlhLWhhc3BvcHVwJzogJ2xpc3Rib3gnLAogICAgICAgICdhcmlhLWV4cGFuZGVkJzogU3RyaW5nKHRoaXMuaXNNZW51QWN0aXZlKSwKICAgICAgICAnYXJpYS1vd25zJzogdGhpcy5jb21wdXRlZE93bnMKICAgICAgfTsKICAgICAgcmV0dXJuIHJlbmRlcjsKICAgIH0sCgogICAgZ2VuTGlzdCgpIHsKICAgICAgLy8gSWYgdGhlcmUncyBubyBzbG90cywgd2UgY2FuIHVzZSBhIGNhY2hlZCBWTm9kZSB0byBpbXByb3ZlIHBlcmZvcm1hbmNlCiAgICAgIGlmICh0aGlzLiRzbG90c1snbm8tZGF0YSddIHx8IHRoaXMuJHNsb3RzWydwcmVwZW5kLWl0ZW0nXSB8fCB0aGlzLiRzbG90c1snYXBwZW5kLWl0ZW0nXSkgewogICAgICAgIHJldHVybiB0aGlzLmdlbkxpc3RXaXRoU2xvdCgpOwogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiB0aGlzLnN0YXRpY0xpc3Q7CiAgICAgIH0KICAgIH0sCgogICAgZ2VuTGlzdFdpdGhTbG90KCkgewogICAgICBjb25zdCBzbG90cyA9IFsncHJlcGVuZC1pdGVtJywgJ25vLWRhdGEnLCAnYXBwZW5kLWl0ZW0nXS5maWx0ZXIoc2xvdE5hbWUgPT4gdGhpcy4kc2xvdHNbc2xvdE5hbWVdKS5tYXAoc2xvdE5hbWUgPT4gdGhpcy4kY3JlYXRlRWxlbWVudCgndGVtcGxhdGUnLCB7CiAgICAgICAgc2xvdDogc2xvdE5hbWUKICAgICAgfSwgdGhpcy4kc2xvdHNbc2xvdE5hbWVdKSk7IC8vIFJlcXVpcmVzIGRlc3RydWN0dXJpbmcgZHVlIHRvIFZ1ZQogICAgICAvLyBtb2RpZnlpbmcgdGhlIGBvbmAgcHJvcGVydHkgd2hlbiBwYXNzZWQKICAgICAgLy8gYXMgYSByZWZlcmVuY2VkIG9iamVjdAoKICAgICAgcmV0dXJuIHRoaXMuJGNyZWF0ZUVsZW1lbnQoVlNlbGVjdExpc3QsIHsgLi4udGhpcy5saXN0RGF0YQogICAgICB9LCBzbG90cyk7CiAgICB9LAoKICAgIGdlbk1lbnUoKSB7CiAgICAgIGNvbnN0IHByb3BzID0gdGhpcy4kX21lbnVQcm9wczsKICAgICAgcHJvcHMuYWN0aXZhdG9yID0gdGhpcy4kcmVmc1snaW5wdXQtc2xvdCddOyAvLyBBdHRhY2ggdG8gcm9vdCBlbCBzbyB0aGF0CiAgICAgIC8vIG1lbnUgY292ZXJzIHByZXBlbmQvYXBwZW5kIGljb25zCgogICAgICBpZiAoIC8vIFRPRE86IG1ha2UgdGhpcyBhIGNvbXB1dGVkIHByb3BlcnR5IG9yIGhlbHBlciBvciBzb21ldGhpbmcKICAgICAgdGhpcy5hdHRhY2ggPT09ICcnIHx8IC8vIElmIHVzZWQgYXMgYSBib29sZWFuIHByb3AgKDx2LW1lbnUgYXR0YWNoPikKICAgICAgdGhpcy5hdHRhY2ggPT09IHRydWUgfHwgLy8gSWYgYm91bmQgdG8gYSBib29sZWFuICg8di1tZW51IDphdHRhY2g9InRydWUiPikKICAgICAgdGhpcy5hdHRhY2ggPT09ICdhdHRhY2gnIC8vIElmIGJvdW5kIGFzIGJvb2xlYW4gcHJvcCBpbiBwdWcgKHYtbWVudShhdHRhY2gpKQogICAgICApIHsKICAgICAgICAgIHByb3BzLmF0dGFjaCA9IHRoaXMuJGVsOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgcHJvcHMuYXR0YWNoID0gdGhpcy5hdHRhY2g7CiAgICAgIH0KCiAgICAgIHJldHVybiB0aGlzLiRjcmVhdGVFbGVtZW50KFZNZW51LCB7CiAgICAgICAgYXR0cnM6IHsKICAgICAgICAgIHJvbGU6IHVuZGVmaW5lZAogICAgICAgIH0sCiAgICAgICAgcHJvcHMsCiAgICAgICAgb246IHsKICAgICAgICAgIGlucHV0OiB2YWwgPT4gewogICAgICAgICAgICB0aGlzLmlzTWVudUFjdGl2ZSA9IHZhbDsKICAgICAgICAgICAgdGhpcy5pc0ZvY3VzZWQgPSB2YWw7CiAgICAgICAgICB9LAogICAgICAgICAgc2Nyb2xsOiB0aGlzLm9uU2Nyb2xsCiAgICAgICAgfSwKICAgICAgICByZWY6ICdtZW51JwogICAgICB9LCBbdGhpcy5nZW5MaXN0KCldKTsKICAgIH0sCgogICAgZ2VuU2VsZWN0aW9ucygpIHsKICAgICAgbGV0IGxlbmd0aCA9IHRoaXMuc2VsZWN0ZWRJdGVtcy5sZW5ndGg7CiAgICAgIGNvbnN0IGNoaWxkcmVuID0gbmV3IEFycmF5KGxlbmd0aCk7CiAgICAgIGxldCBnZW5TZWxlY3Rpb247CgogICAgICBpZiAodGhpcy4kc2NvcGVkU2xvdHMuc2VsZWN0aW9uKSB7CiAgICAgICAgZ2VuU2VsZWN0aW9uID0gdGhpcy5nZW5TbG90U2VsZWN0aW9uOwogICAgICB9IGVsc2UgaWYgKHRoaXMuaGFzQ2hpcHMpIHsKICAgICAgICBnZW5TZWxlY3Rpb24gPSB0aGlzLmdlbkNoaXBTZWxlY3Rpb247CiAgICAgIH0gZWxzZSB7CiAgICAgICAgZ2VuU2VsZWN0aW9uID0gdGhpcy5nZW5Db21tYVNlbGVjdGlvbjsKICAgICAgfQoKICAgICAgd2hpbGUgKGxlbmd0aC0tKSB7CiAgICAgICAgY2hpbGRyZW5bbGVuZ3RoXSA9IGdlblNlbGVjdGlvbih0aGlzLnNlbGVjdGVkSXRlbXNbbGVuZ3RoXSwgbGVuZ3RoLCBsZW5ndGggPT09IGNoaWxkcmVuLmxlbmd0aCAtIDEpOwogICAgICB9CgogICAgICByZXR1cm4gdGhpcy4kY3JlYXRlRWxlbWVudCgnZGl2JywgewogICAgICAgIHN0YXRpY0NsYXNzOiAndi1zZWxlY3RfX3NlbGVjdGlvbnMnCiAgICAgIH0sIGNoaWxkcmVuKTsKICAgIH0sCgogICAgZ2VuU2xvdFNlbGVjdGlvbihpdGVtLCBpbmRleCkgewogICAgICByZXR1cm4gdGhpcy4kc2NvcGVkU2xvdHMuc2VsZWN0aW9uKHsKICAgICAgICBhdHRyczogewogICAgICAgICAgY2xhc3M6ICd2LWNoaXAtLXNlbGVjdCcKICAgICAgICB9LAogICAgICAgIHBhcmVudDogdGhpcywKICAgICAgICBpdGVtLAogICAgICAgIGluZGV4LAogICAgICAgIHNlbGVjdDogZSA9PiB7CiAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpOwogICAgICAgICAgdGhpcy5zZWxlY3RlZEluZGV4ID0gaW5kZXg7CiAgICAgICAgfSwKICAgICAgICBzZWxlY3RlZDogaW5kZXggPT09IHRoaXMuc2VsZWN0ZWRJbmRleCwKICAgICAgICBkaXNhYmxlZDogIXRoaXMuaXNJbnRlcmFjdGl2ZQogICAgICB9KTsKICAgIH0sCgogICAgZ2V0TWVudUluZGV4KCkgewogICAgICByZXR1cm4gdGhpcy4kcmVmcy5tZW51ID8gdGhpcy4kcmVmcy5tZW51Lmxpc3RJbmRleCA6IC0xOwogICAgfSwKCiAgICBnZXREaXNhYmxlZChpdGVtKSB7CiAgICAgIHJldHVybiBnZXRQcm9wZXJ0eUZyb21JdGVtKGl0ZW0sIHRoaXMuaXRlbURpc2FibGVkLCBmYWxzZSk7CiAgICB9LAoKICAgIGdldFRleHQoaXRlbSkgewogICAgICByZXR1cm4gZ2V0UHJvcGVydHlGcm9tSXRlbShpdGVtLCB0aGlzLml0ZW1UZXh0LCBpdGVtKTsKICAgIH0sCgogICAgZ2V0VmFsdWUoaXRlbSkgewogICAgICByZXR1cm4gZ2V0UHJvcGVydHlGcm9tSXRlbShpdGVtLCB0aGlzLml0ZW1WYWx1ZSwgdGhpcy5nZXRUZXh0KGl0ZW0pKTsKICAgIH0sCgogICAgb25CbHVyKGUpIHsKICAgICAgZSAmJiB0aGlzLiRlbWl0KCdibHVyJywgZSk7CiAgICB9LAoKICAgIG9uQ2hpcElucHV0KGl0ZW0pIHsKICAgICAgaWYgKHRoaXMubXVsdGlwbGUpIHRoaXMuc2VsZWN0SXRlbShpdGVtKTtlbHNlIHRoaXMuc2V0VmFsdWUobnVsbCk7IC8vIElmIGFsbCBpdGVtcyBoYXZlIGJlZW4gZGVsZXRlZCwKICAgICAgLy8gb3BlbiBgdi1tZW51YAoKICAgICAgaWYgKHRoaXMuc2VsZWN0ZWRJdGVtcy5sZW5ndGggPT09IDApIHsKICAgICAgICB0aGlzLmlzTWVudUFjdGl2ZSA9IHRydWU7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5pc01lbnVBY3RpdmUgPSBmYWxzZTsKICAgICAgfQoKICAgICAgdGhpcy5zZWxlY3RlZEluZGV4ID0gLTE7CiAgICB9LAoKICAgIG9uQ2xpY2soZSkgewogICAgICBpZiAoIXRoaXMuaXNJbnRlcmFjdGl2ZSkgcmV0dXJuOwoKICAgICAgaWYgKCF0aGlzLmlzQXBwZW5kSW5uZXIoZS50YXJnZXQpKSB7CiAgICAgICAgdGhpcy5pc01lbnVBY3RpdmUgPSB0cnVlOwogICAgICB9CgogICAgICBpZiAoIXRoaXMuaXNGb2N1c2VkKSB7CiAgICAgICAgdGhpcy5pc0ZvY3VzZWQgPSB0cnVlOwogICAgICAgIHRoaXMuJGVtaXQoJ2ZvY3VzJyk7CiAgICAgIH0KCiAgICAgIHRoaXMuJGVtaXQoJ2NsaWNrJywgZSk7CiAgICB9LAoKICAgIG9uRXNjRG93bihlKSB7CiAgICAgIGUucHJldmVudERlZmF1bHQoKTsKCiAgICAgIGlmICh0aGlzLmlzTWVudUFjdGl2ZSkgewogICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7CiAgICAgICAgdGhpcy5pc01lbnVBY3RpdmUgPSBmYWxzZTsKICAgICAgfQogICAgfSwKCiAgICBvbktleVByZXNzKGUpIHsKICAgICAgaWYgKHRoaXMubXVsdGlwbGUgfHwgIXRoaXMuaXNJbnRlcmFjdGl2ZSB8fCB0aGlzLmRpc2FibGVMb29rdXApIHJldHVybjsKICAgICAgY29uc3QgS0VZQk9BUkRfTE9PS1VQX1RIUkVTSE9MRCA9IDEwMDA7IC8vIG1pbGxpc2Vjb25kcwoKICAgICAgY29uc3Qgbm93ID0gcGVyZm9ybWFuY2Uubm93KCk7CgogICAgICBpZiAobm93IC0gdGhpcy5rZXlib2FyZExvb2t1cExhc3RUaW1lID4gS0VZQk9BUkRfTE9PS1VQX1RIUkVTSE9MRCkgewogICAgICAgIHRoaXMua2V5Ym9hcmRMb29rdXBQcmVmaXggPSAnJzsKICAgICAgfQoKICAgICAgdGhpcy5rZXlib2FyZExvb2t1cFByZWZpeCArPSBlLmtleS50b0xvd2VyQ2FzZSgpOwogICAgICB0aGlzLmtleWJvYXJkTG9va3VwTGFzdFRpbWUgPSBub3c7CiAgICAgIGNvbnN0IGluZGV4ID0gdGhpcy5hbGxJdGVtcy5maW5kSW5kZXgoaXRlbSA9PiB7CiAgICAgICAgY29uc3QgdGV4dCA9ICh0aGlzLmdldFRleHQoaXRlbSkgfHwgJycpLnRvU3RyaW5nKCk7CiAgICAgICAgcmV0dXJuIHRleHQudG9Mb3dlckNhc2UoKS5zdGFydHNXaXRoKHRoaXMua2V5Ym9hcmRMb29rdXBQcmVmaXgpOwogICAgICB9KTsKICAgICAgY29uc3QgaXRlbSA9IHRoaXMuYWxsSXRlbXNbaW5kZXhdOwoKICAgICAgaWYgKGluZGV4ICE9PSAtMSkgewogICAgICAgIHRoaXMubGFzdEl0ZW0gPSBNYXRoLm1heCh0aGlzLmxhc3RJdGVtLCBpbmRleCArIDUpOwogICAgICAgIHRoaXMuc2V0VmFsdWUodGhpcy5yZXR1cm5PYmplY3QgPyBpdGVtIDogdGhpcy5nZXRWYWx1ZShpdGVtKSk7CiAgICAgICAgdGhpcy4kbmV4dFRpY2soKCkgPT4gdGhpcy4kcmVmcy5tZW51LmdldFRpbGVzKCkpOwogICAgICAgIHNldFRpbWVvdXQoKCkgPT4gdGhpcy5zZXRNZW51SW5kZXgoaW5kZXgpKTsKICAgICAgfQogICAgfSwKCiAgICBvbktleURvd24oZSkgewogICAgICBpZiAodGhpcy5pc1JlYWRvbmx5ICYmIGUua2V5Q29kZSAhPT0ga2V5Q29kZXMudGFiKSByZXR1cm47CiAgICAgIGNvbnN0IGtleUNvZGUgPSBlLmtleUNvZGU7CiAgICAgIGNvbnN0IG1lbnUgPSB0aGlzLiRyZWZzLm1lbnU7IC8vIElmIGVudGVyLCBzcGFjZSwgb3BlbiBtZW51CgogICAgICBpZiAoW2tleUNvZGVzLmVudGVyLCBrZXlDb2Rlcy5zcGFjZV0uaW5jbHVkZXMoa2V5Q29kZSkpIHRoaXMuYWN0aXZhdGVNZW51KCk7CiAgICAgIHRoaXMuJGVtaXQoJ2tleWRvd24nLCBlKTsKICAgICAgaWYgKCFtZW51KSByZXR1cm47IC8vIElmIG1lbnUgaXMgYWN0aXZlLCBhbGxvdyBkZWZhdWx0CiAgICAgIC8vIGxpc3RJbmRleCBjaGFuZ2UgZnJvbSBtZW51CgogICAgICBpZiAodGhpcy5pc01lbnVBY3RpdmUgJiYga2V5Q29kZSAhPT0ga2V5Q29kZXMudGFiKSB7CiAgICAgICAgdGhpcy4kbmV4dFRpY2soKCkgPT4gewogICAgICAgICAgbWVudS5jaGFuZ2VMaXN0SW5kZXgoZSk7CiAgICAgICAgICB0aGlzLiRlbWl0KCd1cGRhdGU6bGlzdC1pbmRleCcsIG1lbnUubGlzdEluZGV4KTsKICAgICAgICB9KTsKICAgICAgfSAvLyBJZiBtZW51IGlzIG5vdCBhY3RpdmUsIHVwIGFuZCBkb3duIGNhbiBkbwogICAgICAvLyBvbmUgb2YgMiB0aGluZ3MuIElmIG11bHRpcGxlLCBvcGVucyB0aGUKICAgICAgLy8gbWVudSwgaWYgbm90LCB3aWxsIGN5Y2xlIHRocm91Z2ggYWxsCiAgICAgIC8vIGF2YWlsYWJsZSBvcHRpb25zCgoKICAgICAgaWYgKCF0aGlzLmlzTWVudUFjdGl2ZSAmJiBba2V5Q29kZXMudXAsIGtleUNvZGVzLmRvd25dLmluY2x1ZGVzKGtleUNvZGUpKSByZXR1cm4gdGhpcy5vblVwRG93bihlKTsgLy8gSWYgZXNjYXBlIGRlYWN0aXZhdGUgdGhlIG1lbnUKCiAgICAgIGlmIChrZXlDb2RlID09PSBrZXlDb2Rlcy5lc2MpIHJldHVybiB0aGlzLm9uRXNjRG93bihlKTsgLy8gSWYgdGFiIC0gc2VsZWN0IGl0ZW0gb3IgY2xvc2UgbWVudQoKICAgICAgaWYgKGtleUNvZGUgPT09IGtleUNvZGVzLnRhYikgcmV0dXJuIHRoaXMub25UYWJEb3duKGUpOyAvLyBJZiBzcGFjZSBwcmV2ZW50RGVmYXVsdAoKICAgICAgaWYgKGtleUNvZGUgPT09IGtleUNvZGVzLnNwYWNlKSByZXR1cm4gdGhpcy5vblNwYWNlRG93bihlKTsKICAgIH0sCgogICAgb25NZW51QWN0aXZlQ2hhbmdlKHZhbCkgewogICAgICAvLyBJZiBtZW51IGlzIGNsb3NpbmcgYW5kIG11bGl0cGxlCiAgICAgIC8vIG9yIG1lbnVJbmRleCBpcyBhbHJlYWR5IHNldAogICAgICAvLyBza2lwIG1lbnUgaW5kZXggcmVjYWxjdWxhdGlvbgogICAgICBpZiAodGhpcy5tdWx0aXBsZSAmJiAhdmFsIHx8IHRoaXMuZ2V0TWVudUluZGV4KCkgPiAtMSkgcmV0dXJuOwogICAgICBjb25zdCBtZW51ID0gdGhpcy4kcmVmcy5tZW51OwogICAgICBpZiAoIW1lbnUgfHwgIXRoaXMuaXNEaXJ0eSkgcmV0dXJuOyAvLyBXaGVuIG1lbnUgb3BlbnMsIHNldCBpbmRleCBvZiBmaXJzdCBhY3RpdmUgaXRlbQoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBtZW51LnRpbGVzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgaWYgKG1lbnUudGlsZXNbaV0uZ2V0QXR0cmlidXRlKCdhcmlhLXNlbGVjdGVkJykgPT09ICd0cnVlJykgewogICAgICAgICAgdGhpcy5zZXRNZW51SW5kZXgoaSk7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgIH0KICAgIH0sCgogICAgb25Nb3VzZVVwKGUpIHsKICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIHNvbmFyanMvbm8tY29sbGFwc2libGUtaWYKICAgICAgaWYgKHRoaXMuaGFzTW91c2VEb3duICYmIGUud2hpY2ggIT09IDMgJiYgdGhpcy5pc0ludGVyYWN0aXZlKSB7CiAgICAgICAgLy8gSWYgYXBwZW5kIGlubmVyIGlzIHByZXNlbnQKICAgICAgICAvLyBhbmQgdGhlIHRhcmdldCBpcyBpdHNlbGYKICAgICAgICAvLyBvciBpbnNpZGUsIHRvZ2dsZSBtZW51CiAgICAgICAgaWYgKHRoaXMuaXNBcHBlbmRJbm5lcihlLnRhcmdldCkpIHsKICAgICAgICAgIHRoaXMuJG5leHRUaWNrKCgpID0+IHRoaXMuaXNNZW51QWN0aXZlID0gIXRoaXMuaXNNZW51QWN0aXZlKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIFZUZXh0RmllbGQub3B0aW9ucy5tZXRob2RzLm9uTW91c2VVcC5jYWxsKHRoaXMsIGUpOwogICAgfSwKCiAgICBvblNjcm9sbCgpIHsKICAgICAgaWYgKCF0aGlzLmlzTWVudUFjdGl2ZSkgewogICAgICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZSgoKSA9PiB0aGlzLmdldENvbnRlbnQoKS5zY3JvbGxUb3AgPSAwKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBpZiAodGhpcy5sYXN0SXRlbSA+IHRoaXMuY29tcHV0ZWRJdGVtcy5sZW5ndGgpIHJldHVybjsKICAgICAgICBjb25zdCBzaG93TW9yZUl0ZW1zID0gdGhpcy5nZXRDb250ZW50KCkuc2Nyb2xsSGVpZ2h0IC0gKHRoaXMuZ2V0Q29udGVudCgpLnNjcm9sbFRvcCArIHRoaXMuZ2V0Q29udGVudCgpLmNsaWVudEhlaWdodCkgPCAyMDA7CgogICAgICAgIGlmIChzaG93TW9yZUl0ZW1zKSB7CiAgICAgICAgICB0aGlzLmxhc3RJdGVtICs9IDIwOwogICAgICAgIH0KICAgICAgfQogICAgfSwKCiAgICBvblNwYWNlRG93bihlKSB7CiAgICAgIGUucHJldmVudERlZmF1bHQoKTsKICAgIH0sCgogICAgb25UYWJEb3duKGUpIHsKICAgICAgY29uc3QgbWVudSA9IHRoaXMuJHJlZnMubWVudTsKICAgICAgaWYgKCFtZW51KSByZXR1cm47CiAgICAgIGNvbnN0IGFjdGl2ZVRpbGUgPSBtZW51LmFjdGl2ZVRpbGU7IC8vIEFuIGl0ZW0gdGhhdCBpcyBzZWxlY3RlZCBieQogICAgICAvLyBtZW51LWluZGV4IHNob3VsZCB0b2dnbGVkCgogICAgICBpZiAoIXRoaXMubXVsdGlwbGUgJiYgYWN0aXZlVGlsZSAmJiB0aGlzLmlzTWVudUFjdGl2ZSkgewogICAgICAgIGUucHJldmVudERlZmF1bHQoKTsKICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpOwogICAgICAgIGFjdGl2ZVRpbGUuY2xpY2soKTsKICAgICAgfSBlbHNlIHsKICAgICAgICAvLyBJZiB3ZSBtYWtlIGl0IGhlcmUsCiAgICAgICAgLy8gdGhlIHVzZXIgaGFzIG5vIHNlbGVjdGVkIGluZGV4ZXMKICAgICAgICAvLyBhbmQgaXMgcHJvYmFibHkgdGFiYmluZyBvdXQKICAgICAgICB0aGlzLmJsdXIoZSk7CiAgICAgIH0KICAgIH0sCgogICAgb25VcERvd24oZSkgewogICAgICBjb25zdCBtZW51ID0gdGhpcy4kcmVmcy5tZW51OwogICAgICBpZiAoIW1lbnUpIHJldHVybjsKICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOyAvLyBNdWx0aXBsZSBzZWxlY3RzIGRvIG5vdCBjeWNsZSB0aGVpciB2YWx1ZQogICAgICAvLyB3aGVuIHByZXNzaW5nIHVwIG9yIGRvd24sIGluc3RlYWQgYWN0aXZhdGUKICAgICAgLy8gdGhlIG1lbnUKCiAgICAgIGlmICh0aGlzLm11bHRpcGxlKSByZXR1cm4gdGhpcy5hY3RpdmF0ZU1lbnUoKTsKICAgICAgY29uc3Qga2V5Q29kZSA9IGUua2V5Q29kZTsgLy8gQ3ljbGUgdGhyb3VnaCBhdmFpbGFibGUgdmFsdWVzIHRvIGFjaGlldmUKICAgICAgLy8gc2VsZWN0IG5hdGl2ZSBiZWhhdmlvcgoKICAgICAgbWVudS5pc0Jvb3RlZCA9IHRydWU7CiAgICAgIHdpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUoKCkgPT4gewogICAgICAgIG1lbnUuZ2V0VGlsZXMoKTsKICAgICAgICBrZXlDb2Rlcy51cCA9PT0ga2V5Q29kZSA/IG1lbnUucHJldlRpbGUoKSA6IG1lbnUubmV4dFRpbGUoKTsKICAgICAgICBtZW51LmFjdGl2ZVRpbGUgJiYgbWVudS5hY3RpdmVUaWxlLmNsaWNrKCk7CiAgICAgIH0pOwogICAgfSwKCiAgICBzZWxlY3RJdGVtKGl0ZW0pIHsKICAgICAgaWYgKCF0aGlzLm11bHRpcGxlKSB7CiAgICAgICAgdGhpcy5zZXRWYWx1ZSh0aGlzLnJldHVybk9iamVjdCA/IGl0ZW0gOiB0aGlzLmdldFZhbHVlKGl0ZW0pKTsKICAgICAgICB0aGlzLmlzTWVudUFjdGl2ZSA9IGZhbHNlOwogICAgICB9IGVsc2UgewogICAgICAgIGNvbnN0IGludGVybmFsVmFsdWUgPSAodGhpcy5pbnRlcm5hbFZhbHVlIHx8IFtdKS5zbGljZSgpOwogICAgICAgIGNvbnN0IGkgPSB0aGlzLmZpbmRFeGlzdGluZ0luZGV4KGl0ZW0pOwogICAgICAgIGkgIT09IC0xID8gaW50ZXJuYWxWYWx1ZS5zcGxpY2UoaSwgMSkgOiBpbnRlcm5hbFZhbHVlLnB1c2goaXRlbSk7CiAgICAgICAgdGhpcy5zZXRWYWx1ZShpbnRlcm5hbFZhbHVlLm1hcChpID0+IHsKICAgICAgICAgIHJldHVybiB0aGlzLnJldHVybk9iamVjdCA/IGkgOiB0aGlzLmdldFZhbHVlKGkpOwogICAgICAgIH0pKTsgLy8gV2hlbiBzZWxlY3RpbmcgbXVsdGlwbGUKICAgICAgICAvLyBhZGp1c3QgbWVudSBhZnRlciBlYWNoCiAgICAgICAgLy8gc2VsZWN0aW9uCgogICAgICAgIHRoaXMuJG5leHRUaWNrKCgpID0+IHsKICAgICAgICAgIHRoaXMuJHJlZnMubWVudSAmJiB0aGlzLiRyZWZzLm1lbnUudXBkYXRlRGltZW5zaW9ucygpOwogICAgICAgIH0pOyAvLyBXZSBvbmx5IG5lZWQgdG8gcmVzZXQgbGlzdCBpbmRleCBmb3IgbXVsdGlwbGUKICAgICAgICAvLyB0byBrZWVwIGhpZ2hsaWdodCB3aGVuIGFuIGl0ZW0gaXMgdG9nZ2xlZAogICAgICAgIC8vIG9uIGFuZCBvZmYKCiAgICAgICAgaWYgKCF0aGlzLm11bHRpcGxlKSByZXR1cm47CiAgICAgICAgY29uc3QgbGlzdEluZGV4ID0gdGhpcy5nZXRNZW51SW5kZXgoKTsKICAgICAgICB0aGlzLnNldE1lbnVJbmRleCgtMSk7IC8vIFRoZXJlIGlzIG5vIGl0ZW0gdG8gcmUtaGlnaGxpZ2h0CiAgICAgICAgLy8gd2hlbiBzZWxlY3Rpb25zIGFyZSBoaWRkZW4KCiAgICAgICAgaWYgKHRoaXMuaGlkZVNlbGVjdGVkKSByZXR1cm47CiAgICAgICAgdGhpcy4kbmV4dFRpY2soKCkgPT4gdGhpcy5zZXRNZW51SW5kZXgobGlzdEluZGV4KSk7CiAgICAgIH0KICAgIH0sCgogICAgc2V0TWVudUluZGV4KGluZGV4KSB7CiAgICAgIHRoaXMuJHJlZnMubWVudSAmJiAodGhpcy4kcmVmcy5tZW51Lmxpc3RJbmRleCA9IGluZGV4KTsKICAgIH0sCgogICAgc2V0U2VsZWN0ZWRJdGVtcygpIHsKICAgICAgY29uc3Qgc2VsZWN0ZWRJdGVtcyA9IFtdOwogICAgICBjb25zdCB2YWx1ZXMgPSAhdGhpcy5tdWx0aXBsZSB8fCAhQXJyYXkuaXNBcnJheSh0aGlzLmludGVybmFsVmFsdWUpID8gW3RoaXMuaW50ZXJuYWxWYWx1ZV0gOiB0aGlzLmludGVybmFsVmFsdWU7CgogICAgICBmb3IgKGNvbnN0IHZhbHVlIG9mIHZhbHVlcykgewogICAgICAgIGNvbnN0IGluZGV4ID0gdGhpcy5hbGxJdGVtcy5maW5kSW5kZXgodiA9PiB0aGlzLnZhbHVlQ29tcGFyYXRvcih0aGlzLmdldFZhbHVlKHYpLCB0aGlzLmdldFZhbHVlKHZhbHVlKSkpOwoKICAgICAgICBpZiAoaW5kZXggPiAtMSkgewogICAgICAgICAgc2VsZWN0ZWRJdGVtcy5wdXNoKHRoaXMuYWxsSXRlbXNbaW5kZXhdKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHRoaXMuc2VsZWN0ZWRJdGVtcyA9IHNlbGVjdGVkSXRlbXM7CiAgICB9LAoKICAgIHNldFZhbHVlKHZhbHVlKSB7CiAgICAgIGNvbnN0IG9sZFZhbHVlID0gdGhpcy5pbnRlcm5hbFZhbHVlOwogICAgICB0aGlzLmludGVybmFsVmFsdWUgPSB2YWx1ZTsKICAgICAgdmFsdWUgIT09IG9sZFZhbHVlICYmIHRoaXMuJGVtaXQoJ2NoYW5nZScsIHZhbHVlKTsKICAgIH0sCgogICAgaXNBcHBlbmRJbm5lcih0YXJnZXQpIHsKICAgICAgLy8gcmV0dXJuIHRydWUgaWYgYXBwZW5kIGlubmVyIGlzIHByZXNlbnQKICAgICAgLy8gYW5kIHRoZSB0YXJnZXQgaXMgaXRzZWxmIG9yIGluc2lkZQogICAgICBjb25zdCBhcHBlbmRJbm5lciA9IHRoaXMuJHJlZnNbJ2FwcGVuZC1pbm5lciddOwogICAgICByZXR1cm4gYXBwZW5kSW5uZXIgJiYgKGFwcGVuZElubmVyID09PSB0YXJnZXQgfHwgYXBwZW5kSW5uZXIuY29udGFpbnModGFyZ2V0KSk7CiAgICB9CgogIH0KfSk7"},null]}